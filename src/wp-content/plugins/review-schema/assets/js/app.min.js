!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof module&&module.exports?module.exports=function(e,r){return void 0===r&&(r="undefined"!=typeof window?require("jquery"):require("jquery")(e)),t(r),r}:t(jQuery)}((function(t){"use strict";function e(t,r){if(!(this instanceof e)){var n=new e(t,r);return n.open(),n}this.id=e.id++,this.setup(t,r),this.chainCallbacks(e._callbackChain)}if(void 0!==t)if(t.fn.jquery.match(/-ajax/))"console"in window&&window.console.info("Featherlight needs regular jQuery, not the slim version.");else{var r=[],n=function(e){return r=t.grep(r,(function(t){return t!==e&&t.$instance.closest("body").length>0}))},a={allow:1,allowfullscreen:1,frameborder:1,height:1,longdesc:1,marginheight:1,marginwidth:1,mozallowfullscreen:1,name:1,referrerpolicy:1,sandbox:1,scrolling:1,src:1,srcdoc:1,style:1,webkitallowfullscreen:1,width:1},i={keyup:"onKeyUp",resize:"onResize"},s=function(r){t.each(e.opened().reverse(),(function(){return r.isDefaultPrevented()||!1!==this[i[r.type]](r)?void 0:(r.preventDefault(),r.stopPropagation(),!1)}))},o=function(r){if(r!==e._globalHandlerInstalled){e._globalHandlerInstalled=r;var n=t.map(i,(function(t,r){return r+"."+e.prototype.namespace})).join(" ");t(window)[r?"on":"off"](n,s)}};e.prototype={constructor:e,namespace:"featherlight",targetAttr:"data-featherlight",variant:null,resetCss:!1,background:null,openTrigger:"click",closeTrigger:"click",filter:null,root:"body",openSpeed:250,closeSpeed:250,closeOnClick:"background",closeOnEsc:!0,closeIcon:"&#10005;",loading:"",persist:!1,otherClose:null,beforeOpen:t.noop,beforeContent:t.noop,beforeClose:t.noop,afterOpen:t.noop,afterContent:t.noop,afterClose:t.noop,onKeyUp:t.noop,onResize:t.noop,type:null,contentFilters:["jquery","image","html","ajax","iframe","text"],setup:function(e,r){"object"!=typeof e||e instanceof t!=0||r||(r=e,e=void 0);var n=t.extend(this,r,{target:e}),a=n.resetCss?n.namespace+"-reset":n.namespace,i=t(n.background||['<div class="'+a+"-loading "+a+'">','<div class="'+a+'-content">','<button class="'+a+"-close-icon "+n.namespace+'-close" aria-label="Close">',n.closeIcon,"</button>",'<div class="'+n.namespace+'-inner">'+n.loading+"</div>","</div>","</div>"].join("")),s="."+n.namespace+"-close"+(n.otherClose?","+n.otherClose:"");return n.$instance=i.clone().addClass(n.variant),n.$instance.on(n.closeTrigger+"."+n.namespace,(function(e){if(!e.isDefaultPrevented()){var r=t(e.target);("background"===n.closeOnClick&&r.is("."+n.namespace)||"anywhere"===n.closeOnClick||r.closest(s).length)&&(n.close(e),e.preventDefault())}})),this},getContent:function(){if(!1!==this.persist&&this.$content)return this.$content;var e=this,r=this.constructor.contentFilters,n=function(t){return e.$currentTarget&&e.$currentTarget.attr(t)},a=n(e.targetAttr),i=e.target||a||"",s=r[e.type];if(!s&&i in r&&(s=r[i],i=e.target&&a),i=i||n("href")||"",!s)for(var o in r)e[o]&&(s=r[o],i=e[o]);if(!s){var c=i;if(i=null,t.each(e.contentFilters,(function(){return(s=r[this]).test&&(i=s.test(c)),!i&&s.regex&&c.match&&c.match(s.regex)&&(i=c),!i})),!i)return"console"in window&&window.console.error("Featherlight: no content filter found "+(c?' for "'+c+'"':" (no target specified)")),!1}return s.process.call(e,i)},setContent:function(e){return this.$instance.removeClass(this.namespace+"-loading"),this.$instance.toggleClass(this.namespace+"-iframe",e.is("iframe")),this.$instance.find("."+this.namespace+"-inner").not(e).slice(1).remove().end().replaceWith(t.contains(this.$instance[0],e[0])?"":e),this.$content=e.addClass(this.namespace+"-inner"),this},open:function(e){var n=this;if(n.$instance.hide().appendTo(n.root),!(e&&e.isDefaultPrevented()||!1===n.beforeOpen(e))){e&&e.preventDefault();var a=n.getContent();if(a)return r.push(n),o(!0),n.$instance.fadeIn(n.openSpeed),n.beforeContent(e),t.when(a).always((function(t){t&&(n.setContent(t),n.afterContent(e))})).then(n.$instance.promise()).done((function(){n.afterOpen(e)}))}return n.$instance.detach(),t.Deferred().reject().promise()},close:function(e){var r=this,a=t.Deferred();return!1===r.beforeClose(e)?a.reject():(0===n(r).length&&o(!1),r.$instance.fadeOut(r.closeSpeed,(function(){r.$instance.detach(),r.afterClose(e),a.resolve()}))),a.promise()},resize:function(t,e){if(t&&e){this.$content.css("width","").css("height","");var r=Math.max(t/(this.$content.parent().width()-1),e/(this.$content.parent().height()-1));r>1&&(r=e/Math.floor(e/r),this.$content.css("width",t/r+"px").css("height",e/r+"px"))}},chainCallbacks:function(e){for(var r in e)this[r]=t.proxy(e[r],this,t.proxy(this[r],this))}},t.extend(e,{id:0,autoBind:"[data-featherlight]",defaults:e.prototype,contentFilters:{jquery:{regex:/^[#.]\w/,test:function(e){return e instanceof t&&e},process:function(e){return!1!==this.persist?t(e):t(e).clone(!0)}},image:{regex:/\.(png|jpg|jpeg|gif|tiff?|bmp|svg)(\?\S*)?$/i,process:function(e){var r=t.Deferred(),n=new Image,a=t('<img src="'+e+'" alt="" class="'+this.namespace+'-image" />');return n.onload=function(){a.naturalWidth=n.width,a.naturalHeight=n.height,r.resolve(a)},n.onerror=function(){r.reject(a)},n.src=e,r.promise()}},html:{regex:/^\s*<[\w!][^<]*>/,process:function(e){return t(e)}},ajax:{regex:/./,process:function(e){var r=t.Deferred(),n=t("<div></div>").load(e,(function(t,e){"error"!==e&&r.resolve(n.contents()),r.reject()}));return r.promise()}},iframe:{process:function(e){var r=new t.Deferred,n=t("<iframe/>"),i=function(t,e){var r={},n=new RegExp("^"+e+"([A-Z])(.*)");for(var a in t){var i=a.match(n);i&&(r[(i[1]+i[2].replace(/([A-Z])/g,"-$1")).toLowerCase()]=t[a])}return r}(this,"iframe"),s=function(t,e){var r={};for(var n in t)n in e&&(r[n]=t[n],delete t[n]);return r}(i,a);return n.hide().attr("src",e).attr(s).css(i).on("load",(function(){r.resolve(n.show())})).appendTo(this.$instance.find("."+this.namespace+"-content")),r.promise()}},text:{process:function(e){return t("<div>",{text:e})}}},functionAttributes:["beforeOpen","afterOpen","beforeContent","afterContent","beforeClose","afterClose"],readElementConfig:function(e,r){var n=this,a=new RegExp("^data-"+r+"-(.*)"),i={};return e&&e.attributes&&t.each(e.attributes,(function(){var e=this.name.match(a);if(e){var r=this.value,s=t.camelCase(e[1]);if(t.inArray(s,n.functionAttributes)>=0)r=new Function(r);else try{r=JSON.parse(r)}catch(t){}i[s]=r}})),i},extend:function(e,r){var n=function(){this.constructor=e};return n.prototype=this.prototype,e.prototype=new n,e.__super__=this.prototype,t.extend(e,this,r),e.defaults=e.prototype,e},attach:function(e,r,n){var a=this;"object"!=typeof r||r instanceof t!=0||n||(n=r,r=void 0);var i,s=(n=t.extend({},n)).namespace||a.defaults.namespace,o=t.extend({},a.defaults,a.readElementConfig(e[0],s),n),c=function(s){var c=t(s.currentTarget),l=t.extend({$source:e,$currentTarget:c},a.readElementConfig(e[0],o.namespace),a.readElementConfig(s.currentTarget,o.namespace),n),u=i||c.data("featherlight-persisted")||new a(r,l);"shared"===u.persist?i=u:!1!==u.persist&&c.data("featherlight-persisted",u),l.$currentTarget.blur&&l.$currentTarget.blur(),u.open(s)};return e.on(o.openTrigger+"."+o.namespace,o.filter,c),{filter:o.filter,handler:c}},current:function(){var t=this.opened();return t[t.length-1]||null},opened:function(){var e=this;return n(),t.grep(r,(function(t){return t instanceof e}))},close:function(t){var e=this.current();return e?e.close(t):void 0},_onReady:function(){var e=this;if(e.autoBind){var r=t(e.autoBind);r.each((function(){e.attach(t(this))})),t(document).on("click",e.autoBind,(function(n){if(!n.isDefaultPrevented()){var a=t(n.currentTarget);if(r.length!==(r=r.add(a)).length){var i=e.attach(a);(!i.filter||t(n.target).parentsUntil(a,i.filter).length>0)&&i.handler(n)}}}))}},_callbackChain:{onKeyUp:function(e,r){return 27===r.keyCode?(this.closeOnEsc&&t.featherlight.close(r),!1):e(r)},beforeOpen:function(e,r){return t(document.documentElement).addClass("with-featherlight"),this._previouslyActive=document.activeElement,this._$previouslyTabbable=t("a, input, select, textarea, iframe, button, iframe, [contentEditable=true]").not("[tabindex]").not(this.$instance.find("button")),this._$previouslyWithTabIndex=t("[tabindex]").not('[tabindex="-1"]'),this._previousWithTabIndices=this._$previouslyWithTabIndex.map((function(e,r){return t(r).attr("tabindex")})),this._$previouslyWithTabIndex.add(this._$previouslyTabbable).attr("tabindex",-1),document.activeElement.blur&&document.activeElement.blur(),e(r)},afterClose:function(r,n){var a=r(n),i=this;return this._$previouslyTabbable.removeAttr("tabindex"),this._$previouslyWithTabIndex.each((function(e,r){t(r).attr("tabindex",i._previousWithTabIndices[e])})),this._previouslyActive.focus(),0===e.opened().length&&t(document.documentElement).removeClass("with-featherlight"),a},onResize:function(t,e){return this.resize(this.$content.naturalWidth,this.$content.naturalHeight),t(e)},afterContent:function(t,e){var r=t(e);return this.$instance.find("[autofocus]:not([disabled])").focus(),this.onResize(e),r}}}),t.featherlight=e,t.fn.featherlight=function(t,r){return e.attach(this,t,r),this},t(document).ready((function(){e._onReady()}))}else"console"in window&&window.console.info("Too much lightness, Featherlight needs jQuery.")})),function(t,e){"use strict";t((function(){function r(e){let r=".rtrs-"+e;t(document).on("click",r+" .rtrs-field-add",(function(n){let a=t(r+" input").length;a++,a>=rtrs.pro_cons_limit&&t(r+" .rtrs-field-add").addClass("rtrs-hidden"),n.preventDefault();let i='<div class="rtrs-input-filed"><span class="rtrs-remove-btn">+</span><input type="text" class="form-control" name="rt_'+e+'[]" placeholder="'+rtrs.write_txt+'"></div>';t(r+" .rtrs-field-add").before(i)})),t(document).on("click",r+" .rtrs-remove-btn",(function(e){e.preventDefault(),t(this).parent().remove();let n=t(r+" input").length;n++,n<=rtrs.pro_cons_limit&&t(r+" .rtrs-field-add").removeClass("rtrs-hidden")}))}r("pros"),r("cons"),rtrs.recaptcha_sitekey&&t("form.rtrs-form-box").on("submit",(function(e){if(!rtrs.recaptcha)return;e.preventDefault();let r=t(this);grecaptcha.ready((function(){grecaptcha.execute(rtrs.recaptcha_sitekey,{action:"reviewForm"}).then((function(e){document.getElementById("gRecaptchaResponse").value=e,r.off("submit").submit(),t(".rtrs-review-submit").trigger("click")}))}))})),t(document).on("click",".rtrs-review-edit-btn",(function(e){e.preventDefault();let r=t(this).attr("data-comment-post-id"),n=t(this).attr("data-comment-id"),i=t(this);t.ajax({type:"post",dataType:"json",url:rtrs.ajaxurl,data:{action:"rtrs_review_edit_form",comment_post_id:r,comment_id:n},beforeSend:function(){i.html("("+rtrs.loading+")")},success:function(e){e.success?(i.html("("+rtrs.edit+")"),t("body").prepend(e.data),a(),t("#rtrs-video-source").on("change",(function(){a()}))):alert(e.data)}})})),t(document).on("click",".rtrs-review-edit-submit",(function(e){e.preventDefault();let r=t(this).parents("form").serialize();t.ajax({type:"post",dataType:"json",url:rtrs.ajaxurl,data:r,success:function(t){t.success?location.reload():console.log(t.data)}})})),t(document).on("mouseup",(function(e){let r=t(".rtrs-review-popup");r.is(e.target)||0!==r.has(e.target).length||t(".rtrs-modal").remove()})),t(document).on("click",".rtrs-review-highlight",(function(e){let r=t(this).data("comment-id"),n=t(this).attr("data-highlight");"highlight"==n?(t(this).html(rtrs.remove_highlight),t(this).attr("data-highlight","remove"),t(this).closest(".rtrs-each-review").addClass("rtrs-top-review")):(t(this).html(rtrs.highlight),t(this).attr("data-highlight","highlight"),t(this).closest(".rtrs-each-review").removeClass("rtrs-top-review")),t.ajax({type:"post",dataType:"json",url:rtrs.ajaxurl,data:{action:"rtrs_review_hightlight",comment_id:r,highlight:n},beforeSend:function(){},success:function(t){}})})),t(document).on("click",".rtrs-review-helpful",(function(e){let r=t(this).data("comment-id"),n=t(this).attr("data-helpful"),a=t(this).attr("data-type"),i=t(this).find(".helpful-count").html();"helpful"==n?(t(this).attr("data-helpful","remove"),i++,t(this).find(".helpful-count").html(i)):(t(this).attr("data-helpful","helpful"),i--,t(this).find(".helpful-count").html(i));let s="like"==a?t(this).next():t(this).prev();if("remove"==s.attr("data-helpful")){s.attr("data-helpful","helpful");let t=s.find(".helpful-count").html();t--,s.find(".helpful-count").html(t)}t.ajax({type:"post",dataType:"json",url:rtrs.ajaxurl,data:{action:"rtrs_review_helpful",comment_id:r,helpful:n,type:a,nonce:rtrs.nonce},beforeSend:function(){},success:function(t){}})})),t(document).on("click",".rtrs-share-review",(function(r){r.preventDefault();let n=t(this).attr("data-url"),a=screen.height/2-300,i=screen.width/2-400;return e.open(n,"","location=1,status=1,resizable=yes,width=800,height=600,top="+a+",left="+i)}));const n=new URL(e.location.href);function a(){"self"==t("#rtrs-video-source").val()?(t(".rtrs-source-video").show(),t(".rtrs-source-external").hide()):(t(".rtrs-source-video").hide(),t(".rtrs-source-external").show())}if(t(".rtrs_review_filter").on("change",(function(r){let a=this.value;"sort"===t(this).data("type")?n.searchParams.set("sort_by",a):n.searchParams.set("filter_by",a),e.history.replaceState(null,null,n);let i=n.searchParams.get("sort_by"),s=n.searchParams.get("filter_by");t.ajax({type:"post",dataType:"json",url:rtrs.ajaxurl,data:{action:"rtrs_review_filter",post_id:rtrs.post_id,sort_by:i,filter_by:s},beforeSend:function(){t(".rtrs-paginate").html(rtrs.loading)},success:function(e){e.success&&(t(".rtrs-review-list").html(e.data.review),t(".rtrs-paginate").html(e.data.pagination))}})})),t(document).on("click","#rtrs-upload-box-image",(function(){t("#rtrs-image").trigger("click")})),t(document).on("change","#rtrs-image",(function(e){let r,n;r=t(this).prop("files")[0],n=new FormData,n.append("rtrs-image",r),n.append("nonce",rtrs.nonce),n.append("action","rtrs_image_upload"),t.ajax({url:rtrs.ajaxurl,type:"POST",contentType:!1,processData:!1,data:n,beforeSend:function(){t(".rtrs-image-error").html(""),t("#rtrs-upload-box-image span").html(rtrs.loading)},success:function(e){e.success?t(".rtrs-preview-imgs").append("<div class='rtrs-preview-img'><img src='"+e.data.file_info.url+"' /><input type='hidden' name='rt_attachment[imgs][]' value='"+e.data.file_info.id+"'><span class='rtrs-file-remove' data-id='"+e.data.file_info.id+"'>x</span></div>"):t(".rtrs-image-error").html(e.data.msg),t("#rtrs-upload-box-image span").html(rtrs.upload_img)}})})),t(document).on("click",".rtrs-file-remove",(function(e){e.preventDefault();let r=t(this).data("id");confirm(rtrs.sure_txt)&&(t(this).parent().remove(),t.ajax({type:"post",dataType:"json",url:rtrs.ajaxurl,data:{action:"rtrs_remove_file",attachment_id:r},success:function(){}}))})),t(document).on("click","#rtrs-upload-box-video",(function(){t("#rtrs-video").trigger("click")})),t(document).on("change","#rtrs-video",(function(e){let r,n;r=t(this).prop("files")[0],n=new FormData,n.append("rtrs-video",r),n.append("nonce",rtrs.nonce),n.append("action","rtrs_video_upload"),t.ajax({url:rtrs.ajaxurl,type:"POST",contentType:!1,processData:!1,data:n,beforeSend:function(){t(".rtrs-video-error").html(""),t("#rtrs-upload-box-video span").html(rtrs.loading)},success:function(e){e.success?t(".rtrs-preview-videos").append("<div class='rtrs-preview-video'><span class='name'>"+e.data.file_info.name+"</span><input type='hidden' name='rt_attachment[videos][]' value='"+e.data.file_info.id+"'><span class='rtrs-file-remove'>x</span></div>"):t(".rtrs-video-error").html(e.data.msg),t("#rtrs-upload-box-video span").html(rtrs.upload_video)}})})),a(),t("#rtrs-video-source").on("change",(function(){a()})),t(document).on("click",".rtrs-play-self-video",(function(e){e.preventDefault();let r=t(this).attr("data-video-url");t.ajax({type:"post",dataType:"json",url:rtrs.ajaxurl,data:{action:"rtrs_self_video_popup",video_url:r},success:function(e){e.success&&t("body").prepend(e.data)}})})),t("body").on("click","#rtrs-load-more",(function(){let e=t("#rtrs-load-more").attr("data-max"),r=t("#rtrs-load-more"),a=n.searchParams.get("sort_by");return t.ajax({url:rtrs.ajaxurl,data:{action:"rtrs_pagination",post_id:rtrs.post_id,current_page:rtrs.current_page,sort_by:a},type:"POST",dataType:"json",beforeSend:function(){r.text(rtrs.loading)},success:function(n){r.text("Load More"),n.success&&t(".rtrs-review-list").append(n.data.review),rtrs.current_page++,rtrs.current_page==e&&r.remove()}}),!1})),t("body").on("click",".rtrs-paginate-ajax a",(function(e){e.preventDefault();let r=t(this).attr("href").match("/comment-page-([0-9]+)/"),a=1;r&&(a=r[1]);let i=t(this).parent().attr("data-max"),s=n.searchParams.get("sort_by");return t.ajax({url:rtrs.ajaxurl,data:{action:"rtrs_pagination",post_id:rtrs.post_id,current_page:a,max_page:i,pagi_num:!0,sort_by:s},type:"POST",dataType:"json",beforeSend:function(){t(".rtrs-paginate-ajax").html(rtrs.loading)},success:function(e){e.success&&(t(".rtrs-review-list").html(e.data.review),t(".rtrs-paginate-ajax").html(e.data.pagination))}}),!1})),t(".rtrs-paginate-onscroll").length>0){let r=!0;t(e).scroll((function(){if(!r)return;let e=t(".rtrs-paginate-onscroll").attr("data-max"),a=n.searchParams.get("sort_by");rtrs.current_page>=e?r=!1:t(document).scrollTop()>t(document).height()-2900&&1==r&&t.ajax({url:rtrs.ajaxurl,data:{action:"rtrs_pagination",post_id:rtrs.post_id,current_page:rtrs.current_page,sort_by:a},type:"POST",dataType:"json",beforeSend:function(){t(".rtrs-paginate-onscroll").html(rtrs.loading),r=!1},success:function(e){e.success&&(t(".rtrs-review-list").append(e.data.review),t(".rtrs-paginate-onscroll").html(""),rtrs.current_page++,r=!0)}})}))}}))}(jQuery,window);
